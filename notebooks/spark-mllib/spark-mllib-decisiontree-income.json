{"paragraphs":[{"text":"%spark\nimport org.apache.spark.mllib.tree.DecisionTree\nimport org.apache.spark.ml.classification.DecisionTreeClassifier\nimport org.apache.spark.ml.Pipeline\nimport org.apache.spark.ml.feature.StringIndexer\nimport org.apache.spark.ml.feature.VectorAssembler\nimport org.apache.spark.ml.feature.IndexToString","user":"anonymous","dateUpdated":"2018-01-03T02:37:27+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1514947047623_1833133789","id":"20180102-221549_574391799","dateCreated":"2018-01-03T02:37:27+0000","dateStarted":"2018-01-03T02:38:40+0000","dateFinished":"2018-01-03T02:39:18+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4303"},{"text":"%spark\nspark.catalog.setCurrentDatabase(\"DATABASE_NAME\")","user":"anonymous","dateUpdated":"2018-01-03T02:40:47+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{"0":{"graph":{"mode":"table","height":424,"optionOpen":false}}},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1514947047629_1829286300","id":"20171218-020812_1798171821","dateCreated":"2018-01-03T02:37:27+0000","dateStarted":"2018-01-03T02:38:43+0000","dateFinished":"2018-01-03T02:39:22+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4304"},{"text":"spark.catalog.listTables().show()","user":"anonymous","dateUpdated":"2018-01-03T02:37:27+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1514947047630_1830440547","id":"20171218-020821_266605350","dateCreated":"2018-01-03T02:37:27+0000","dateStarted":"2018-01-03T02:39:18+0000","dateFinished":"2018-01-03T02:39:25+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4305"},{"text":"val df = spark.sql(\"select * from TABLE_NAME where age is not null\")","user":"anonymous","dateUpdated":"2018-01-03T02:38:35+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1514947047630_1830440547","id":"20171218-021321_776664365","dateCreated":"2018-01-03T02:37:27+0000","dateStarted":"2018-01-03T02:39:22+0000","dateFinished":"2018-01-03T02:39:25+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4306"},{"text":"df.printSchema()","user":"anonymous","dateUpdated":"2018-01-03T02:37:27+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1514947047631_1830055798","id":"20171218-022009_1883419823","dateCreated":"2018-01-03T02:37:27+0000","dateStarted":"2018-01-03T02:39:25+0000","dateFinished":"2018-01-03T02:39:25+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4307"},{"text":"df.show(10)","user":"anonymous","dateUpdated":"2018-01-03T02:37:27+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1514947047631_1830055798","id":"20171218-022051_200665244","dateCreated":"2018-01-03T02:37:27+0000","dateStarted":"2018-01-03T02:39:25+0000","dateFinished":"2018-01-03T02:39:43+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4308"},{"text":"val trainingSize = 0.8\nval testSize = 0.2\n\nval workclass_indexer = new StringIndexer().setInputCol(\"workclass\").setOutputCol(\"workclass-index\").fit(df)\nval edu_indexer = new StringIndexer().setInputCol(\"education\").setOutputCol(\"edu-index\").fit(df)\nval relationship_indexer = new StringIndexer().setInputCol(\"relationship\").setOutputCol(\"reln-index\").fit(df)\nval occupation_indexer = new StringIndexer().setInputCol(\"occupation\").setOutputCol(\"occu-index\").fit(df)\n\nval income_indexer = new StringIndexer().setInputCol(\"income_cat\").setOutputCol(\"category-index\").fit(df)\n\nval assembler = new VectorAssembler().setInputCols(Array(\"age\", \"workclass-index\", \"edu-index\", \"reln-index\", \"occu-index\")).setOutputCol(\"features\")\n\nval Array(trainingData, testData) = df.randomSplit(Array(trainingSize,testSize))\n\nprintln(\"trainingData count:\" + trainingData.count)\nprintln(\"testData count:\" + testData.count)\n\nval dt = new DecisionTreeClassifier().setLabelCol(\"category-index\").setFeaturesCol(\"features\")\nval labelConverter = new IndexToString()\n    .setInputCol(\"prediction\")\n    .setOutputCol(\"predictedLabel\")\n    .setLabels(income_indexer.labels)\n    \nval pipeline = new Pipeline().setStages(Array(workclass_indexer, edu_indexer, relationship_indexer, occupation_indexer, assembler, income_indexer, dt, labelConverter))\n","user":"anonymous","dateUpdated":"2018-01-03T02:37:27+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1514947047632_1840444018","id":"20171218-022135_976865817","dateCreated":"2018-01-03T02:37:27+0000","dateStarted":"2018-01-03T02:39:26+0000","dateFinished":"2018-01-03T02:40:00+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4309"},{"text":"val model = pipeline.fit(trainingData)","user":"anonymous","dateUpdated":"2018-01-03T02:37:27+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1514947047632_1840444018","id":"20171218-025202_63481401","dateCreated":"2018-01-03T02:37:27+0000","dateStarted":"2018-01-03T02:39:43+0000","dateFinished":"2018-01-03T02:40:07+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4310"},{"text":"val preds = model.transform(testData)\nval preds_records = preds.select($\"age\", $\"workclass\", $\"education\", $\"relationship\", $\"probability\", $\"predictedLabel\")\n\npreds_records.show(20)\nprintln(\"count:\" + preds_records.count)\n","user":"anonymous","dateUpdated":"2018-01-03T02:37:27+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1514947047633_1840059270","id":"20171218-031304_1960722418","dateCreated":"2018-01-03T02:37:27+0000","dateStarted":"2018-01-03T02:40:00+0000","dateFinished":"2018-01-03T02:40:10+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4311"},{"text":"val pred_50Kover = preds_records.filter($\"predictedLabel\".contains(\">50K\"))\npred_50Kover.show(10)\nprintln(\"count:\" + pred_50Kover.count)","user":"anonymous","dateUpdated":"2018-01-03T02:38:06+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1514947047633_1840059270","id":"20171218-031627_1008478753","dateCreated":"2018-01-03T02:37:27+0000","dateStarted":"2018-01-03T02:40:07+0000","dateFinished":"2018-01-03T02:40:13+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4312"},{"text":"import org.apache.spark.ml.classification.DecisionTreeClassificationModel\n\nval treeModel = model.stages(6).asInstanceOf[DecisionTreeClassificationModel]\nprintln(\"Learned classification tree model:\\n\" + treeModel.toDebugString)","user":"anonymous","dateUpdated":"2018-01-03T02:37:27+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1514947047634_1841213516","id":"20180102-055212_407214091","dateCreated":"2018-01-03T02:37:27+0000","dateStarted":"2018-01-03T02:40:11+0000","dateFinished":"2018-01-03T02:40:14+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4313"},{"user":"anonymous","dateUpdated":"2018-01-03T02:37:27+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1514947047634_1841213516","id":"20180102-060923_1488088310","dateCreated":"2018-01-03T02:37:27+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4314"}],"name":"Census2","id":"2D4T2TBYS","angularObjects":{"2BRWU4WXC:shared_process":[],"2AM1YV5CU:shared_process":[],"2AJXGMUUJ:shared_process":[],"2ANGGHHMQ:shared_process":[],"2AKK3QQXU:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}